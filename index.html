import React, { useState, useEffect, useRef } from 'react';
import { Heart, Calendar, MapPin, Clock, Phone, Sparkles, BookOpen, Music, Users, Camera, Share2, Award, ChevronDown, QrCode, Navigation, Gift } from 'lucide-react';

const App = () => {
  const [isOpen, setIsOpen] = useState(false);
  const [activeTab, setActiveTab] = useState('english');
  const [scrollProgress, setScrollProgress] = useState(0);
  const [timeLeft, setTimeLeft] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });

  const coupleImage = "https://i.ibb.co/wFwFWvFV/IMG-20260118-131434-208.webp";
  // Beautiful floral/wedding texture for parallax background
  const bgTexture = "https://images.unsplash.com/photo-1519741497674-611481863552?auto=format&fit=crop&q=80&w=2000";
  const albumLink = "https://photos.app.goo.gl/XYoM8Jv3u6oixU5ZA";
  const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(albumLink)}&color=b45309&bgcolor=ffffff`;
  
  // Fixed Map Links
  const homeMapLink = "https://maps.app.goo.gl/WttRhLjhreXaHWjX8"; 
  const banquetMapLink = "https://www.google.com/maps/search/?api=1&query=Karki+Banquet+Maitighat+Kathmandu";

  useEffect(() => {
    const handleScroll = () => {
      const totalScroll = document.documentElement.scrollHeight - window.innerHeight;
      const currentProgress = window.scrollY / totalScroll;
      setScrollProgress(currentProgress);
    };
    window.addEventListener('scroll', handleScroll, { passive: true });
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  useEffect(() => {
    const targetDate = new Date('2026-02-25T00:00:00');
    const timer = setInterval(() => {
      const now = new Date();
      const diff = targetDate.getTime() - now.getTime();
      if (diff < 0) return clearInterval(timer);
      setTimeLeft({
        days: Math.floor(diff / (1000 * 60 * 60 * 24)),
        hours: Math.floor((diff / (1000 * 60 * 60)) % 24),
        minutes: Math.floor((diff / 1000 / 60) % 60),
        seconds: Math.floor((diff / 1000) % 60)
      });
    }, 1000);
    return () => clearInterval(timer);
  }, []);

  const content = {
    english: {
      ganesh: "॥ Shree Ganeshaya Namah ॥",
      inviteText: "With the divine blessings of our ancestors and the grace of God, we cordially invite you to celebrate the wedding ceremony of our beloved son Shakar with Jasmin.",
      groomParents: "Son of Sr. Adv. Tikaram Bhattarai & Indira Dahal Bhattarai",
      brideParents: "Daughter of Jyoti Tiwari & Sita Tiwari",
      weddingDate: "Falgun 13, 2082 (Saturday, Feb 25, 2026)",
      weddingLoc: "Sahabhagita Marg, Baneshwor-10, Kathmandu",
      receptionDate: "Falgun 15, 2082 (Friday, Feb 27, 2026)",
      receptionTime: "03:30 PM to 07:30 PM",
      receptionLoc: "Karki Banquet, Babarmahal, Kathmandu",
      receptionTitle: "Wedding Reception",
      getDirections: "View on Map",
      giftNote: "Your presence is our greatest gift. However, if you wish to honor us with a gift, a contribution towards our future (cash gift) would be sincerely appreciated over physical items.",
      prarthi: "Prarthi",
      hostName: "Indira Dahal Bhattarai",
      contactLabel: "For any assistance (असमर्थता को लागि):",
      contactName: "Tikaram Bhattarai"
    },
    nepali: {
      ganesh: "॥ श्री गणेशाय नम: ॥",
      inviteText: "कुलदेवताको असीम कृपा र पितृहरूको आशिर्वाद स्वरूप हाम्रा साशव पुत्र ई. साकार र ई. जस्मिनको यो मांगलिक विवाह उत्सवमा यहाँको गरिमामय उपस्थितिको लागि हार्दिक निमन्त्रणा गर्दछौं।",
      groomParents: "वरिष्ठ अधिवक्ता टीकाराम भट्टराई र इन्दिरा दाहाल भट्टराईका सुपुत्र",
      brideParents: "ज्योति तिवारी र सीता तिवारीकी सुपुत्री",
      weddingDate: "२०८२ फागुन १३ गते, शनिबार (२५ फेब्रुअरी २०२६)",
      weddingLoc: "सहभागिता मार्ग, बानेश्वर-१०, काठमाडौँ",
      receptionDate: "२०८२ फागुन १५ गते, शुक्रबार (२७ फेब्रुअरी २०२६)",
      receptionTime: "दिउँसो ३:३० देखि बेलुका ७:३० सम्म",
      receptionLoc: "कार्की ब्याङ्क्वेट, बबरमहल, काठमाडौँ",
      receptionTitle: "विवाह भोज (प्रीतिभोज)",
      getDirections: "लोकेसन हेर्नुहोस्",
      giftNote: "यहाँको उपस्थिति नै हाम्रो लागि सबैभन्दा ठूलो उपहार हो। यद्यपि, यहाँले माया स्वरूप केही प्रदान गर्न चाहनुहुन्छ भने भौतिक सामग्रीको सट्टामा नगद उपहारलाई प्राथमिकता दिनुहुन विनम्र अनुरोध गर्दछौं।",
      prarthi: "प्रार्थी",
      hostName: "इन्दिरा दाहाल भट्टराई",
      contactLabel: "असमर्थता को लागि सम्पर्क:",
      contactName: "टीकाराम भट्टराई"
    }
  };

  const t = content[activeTab];

  return (
    <div className="min-h-screen bg-[#FCFBF7] text-[#333] overflow-x-hidden font-serif selection:bg-amber-100 selection:text-amber-900">
      
      {/* Fixed Parallax Background Image */}
      <div 
        className="fixed inset-0 z-0 bg-cover bg-center"
        style={{ 
          backgroundImage: `url(${bgTexture})`,
          opacity: 0.15,
          backgroundAttachment: 'fixed'
        }}
      />
      
      {/* Pattern Overlays */}
      <div className="fixed inset-0 pointer-events-none z-0 opacity-[0.03] bg-[url('https://www.transparenttextures.com/patterns/royal-feather.png')]" />

      {/* Language Toggle */}
      <div className="fixed top-6 right-6 z-[110] flex bg-white/90 backdrop-blur-md rounded-full p-1.5 border border-amber-200 shadow-2xl">
        <button onClick={() => setActiveTab('english')} className={`px-5 py-2 rounded-full text-[10px] font-black tracking-widest transition-all ${activeTab === 'english' ? 'bg-amber-700 text-white shadow-lg' : 'text-amber-800 hover:bg-amber-50'}`}>ENG</button>
        <button onClick={() => setActiveTab('nepali')} className={`px-5 py-2 rounded-full text-[10px] font-black tracking-widest transition-all ${activeTab === 'nepali' ? 'bg-amber-700 text-white shadow-lg' : 'text-amber-800 hover:bg-amber-50'}`}>नेपाली</button>
      </div>

      {/* Entrance Door */}
      {!isOpen && (
        <div className="fixed inset-0 z-[120] flex items-center justify-center bg-[#FDFCF8] transition-all duration-1000 px-6">
          <div className="relative z-10 text-center flex flex-col items-center">
            <div className="mb-12 relative scale-110">
                <div className="absolute inset-0 animate-ping rounded-full border border-amber-200"></div>
                <div className="relative w-28 h-28 border-2 border-amber-600 rounded-full flex items-center justify-center bg-white shadow-2xl">
                    <Heart className="text-amber-600 fill-amber-600" size={44} />
                </div>
            </div>
            <h2 className="text-amber-700 tracking-[0.6em] uppercase text-[10px] mb-6 font-bold">{t.ganesh}</h2>
            <h1 className="text-5xl md:text-8xl font-serif mb-16 text-stone-900 leading-tight">Shakar <span className="text-amber-600 italic font-light">&</span> Jasmin</h1>
            <button 
                onClick={() => setIsOpen(true)} 
                className="bg-amber-700 text-white px-14 py-5 rounded-full text-xs tracking-[0.3em] transition-all duration-500 uppercase font-black shadow-[0_20px_40px_rgba(180,83,9,0.2)] hover:bg-amber-800 hover:translate-y-[-2px]"
            >
                Open Invitation
            </button>
          </div>
        </div>
      )}

      {/* Content Scroller */}
      <div className={`transition-all duration-1000 relative z-10 ${isOpen ? 'opacity-100' : 'opacity-0'}`}>
        
        {/* Hero Section with Parallax Image */}
        <section className="relative h-[90vh] flex flex-col items-center justify-center px-6 overflow-hidden">
          <div className="relative z-[2] text-center">
            <p className="text-amber-700 text-xs tracking-[0.8em] uppercase font-black mb-12 animate-pulse">{t.ganesh}</p>
            
            <div className="relative mx-auto mb-12">
                {/* Floating Ring Effect */}
                <div 
                    className="absolute -inset-10 border border-amber-200 rounded-full opacity-30"
                    style={{ transform: `translateY(${scrollProgress * -60}px) scale(${1 + scrollProgress * 0.1})` }}
                />
                <div className="relative w-64 h-64 md:w-96 md:h-96 overflow-hidden rounded-full border-[12px] border-white shadow-[0_30px_60px_rgba(0,0,0,0.15)]">
                    <img src={coupleImage} alt="Couple" className="w-full h-full object-cover" />
                </div>
            </div>

            <h1 className="text-6xl md:text-9xl font-serif text-stone-900 mb-8 tracking-tighter">
                {activeTab === 'english' ? "Shakar & Jasmin" : "साकार र जस्मिन"}
            </h1>
            
            <div className="flex items-center justify-center gap-8 text-stone-500 tracking-[0.4em] uppercase text-[10px] font-black border-y border-amber-200/50 py-5">
              <span>{activeTab === 'english' ? "FEB 2026" : "फागुन २०८२"}</span>
              <div className="h-2 w-2 bg-amber-600 rounded-full shadow-[0_0_10px_rgba(180,83,9,0.5)]" />
              <span>{activeTab === 'english' ? "KATHMANDU" : "काठमाडौँ"}</span>
            </div>
          </div>
          <div className="absolute bottom-12 animate-bounce text-amber-300"><ChevronDown size={40} strokeWidth={1} /></div>
        </section>

        {/* Invite text on a clean card */}
        <section className="py-32 px-6 bg-white/60 backdrop-blur-sm text-center relative z-20">
          <div className="max-w-4xl mx-auto bg-[#FDFCF8] p-12 md:p-24 rounded-[4rem] shadow-xl border border-amber-100/50">
            <Sparkles className="mx-auto text-amber-500/60 mb-12" size={40} strokeWidth={1} />
            <p className="text-2xl md:text-4xl leading-[1.6] text-stone-800 font-light italic mb-20 px-4">
                {t.inviteText}
            </p>
            
            <div className="grid md:grid-cols-2 gap-12">
                <div className="group p-10 bg-white border border-amber-100 rounded-[2.5rem] shadow-sm hover:shadow-2xl transition-all duration-500">
                    <p className="text-amber-800 text-[10px] tracking-[0.3em] font-black mb-4 uppercase">{activeTab === 'english' ? "The Groom" : "वर"}</p>
                    <h3 className="text-3xl text-stone-900 font-serif mb-4">{activeTab === 'english' ? "Shakar Bhattarai" : "ई. साकार भट्टराई"}</h3>
                    <p className="text-stone-500 text-sm italic leading-relaxed">{t.groomParents}</p>
                </div>
                <div className="group p-10 bg-white border border-amber-100 rounded-[2.5rem] shadow-sm hover:shadow-2xl transition-all duration-500">
                    <p className="text-amber-800 text-[10px] tracking-[0.3em] font-black mb-4 uppercase">{activeTab === 'english' ? "The Bride" : "वधु"}</p>
                    <h3 className="text-3xl text-stone-900 font-serif mb-4">{activeTab === 'english' ? "Jasmin Tiwari" : "ई. जस्मिन तिवारी"}</h3>
                    <p className="text-stone-500 text-sm italic leading-relaxed">{t.brideParents}</p>
                </div>
            </div>
          </div>
        </section>

        {/* Events Cards */}
        <section className="py-32 px-6 bg-transparent relative">
          <div className="max-w-6xl mx-auto relative z-10">
            <div className="grid md:grid-cols-2 gap-16">
              
              <div 
                className="bg-white/90 backdrop-blur-md p-12 rounded-[3rem] border border-amber-100 shadow-2xl flex flex-col hover:scale-[1.02] transition-transform duration-500"
                style={{ transform: `translateY(${scrollProgress * -40}px)` }}
              >
                <div className="w-16 h-16 bg-amber-50 rounded-2xl flex items-center justify-center text-amber-700 mb-10 shadow-inner">
                    <BookOpen size={32} strokeWidth={1.5} />
                </div>
                <h3 className="text-3xl text-stone-900 mb-6 font-serif tracking-tight">{activeTab === 'english' ? "Wedding Ceremony" : "विवाह समारोह"}</h3>
                <div className="space-y-6 text-stone-600 flex-grow text-base">
                    <div className="flex items-center gap-5"><Calendar size={22} className="text-amber-700" /><p className="font-medium text-stone-800">{t.weddingDate}</p></div>
                    <div className="flex items-start gap-5"><MapPin size={22} className="text-amber-700" /><p className="leading-relaxed">{t.weddingLoc}</p></div>
                </div>
                <button 
                    onClick={() => window.open(homeMapLink, '_blank')} 
                    className="mt-12 flex items-center justify-center gap-3 py-4 px-8 border-2 border-amber-600 text-amber-700 rounded-full text-xs font-black tracking-widest hover:bg-amber-600 hover:text-white transition-all shadow-lg shadow-amber-100"
                >
                  <Navigation size={18} /> {t.getDirections}
                </button>
              </div>

              <div 
                className="bg-white/90 backdrop-blur-md p-12 rounded-[3rem] border border-rose-100 shadow-2xl flex flex-col hover:scale-[1.02] transition-transform duration-500"
                style={{ transform: `translateY(${scrollProgress * -20}px)` }}
              >
                <div className="w-16 h-16 bg-rose-50 rounded-2xl flex items-center justify-center text-rose-700 mb-10 shadow-inner">
                    <Music size={32} strokeWidth={1.5} />
                </div>
                <h3 className="text-3xl text-stone-900 mb-6 font-serif tracking-tight">{t.receptionTitle}</h3>
                <div className="space-y-6 text-stone-600 flex-grow text-base">
                    <div className="flex items-center gap-5"><Calendar size={22} className="text-rose-700" /><p className="font-medium text-stone-800">{t.receptionDate}</p></div>
                    <div className="flex items-center gap-5"><Clock size={22} className="text-rose-700" /><p className="font-medium text-stone-800">{t.receptionTime}</p></div>
                    <div className="flex items-start gap-5"><MapPin size={22} className="text-rose-700" /><p className="leading-relaxed">{t.receptionLoc}</p></div>
                </div>
                <button 
                    onClick={() => window.open(banquetMapLink, '_blank')} 
                    className="mt-12 flex items-center justify-center gap-3 py-4 px-8 border-2 border-rose-600 text-rose-700 rounded-full text-xs font-black tracking-widest hover:bg-rose-600 hover:text-white transition-all shadow-lg shadow-rose-100"
                >
                  <Navigation size={18} /> {t.getDirections}
                </button>
              </div>
            </div>
          </div>
        </section>

        {/* Gift Policy */}
        <section className="py-24 px-6 bg-stone-900/5 backdrop-blur-md border-y border-stone-200">
           <div className="max-w-3xl mx-auto text-center">
              <div className="inline-flex p-5 rounded-full bg-white text-amber-700 mb-8 shadow-xl"><Gift size={32} strokeWidth={1.5}/></div>
              <p className="text-lg md:text-xl text-stone-700 leading-relaxed italic px-6 font-medium">
                "{t.giftNote}"
              </p>
           </div>
        </section>

        {/* Photo Album */}
        <section className="py-32 px-6">
            <div className="max-w-5xl mx-auto flex flex-col lg:flex-row items-center justify-center gap-16 bg-white/80 backdrop-blur-xl p-12 lg:p-20 rounded-[4rem] shadow-2xl border border-amber-100 relative overflow-hidden group">
                <div className="text-center lg:text-left flex-grow relative z-10">
                    <h2 className="text-4xl text-stone-900 font-serif mb-6 tracking-tight">{activeTab === 'english' ? "Live Photo Album" : "फोटो एल्बम"}</h2>
                    <p className="text-stone-500 text-lg mb-12 leading-relaxed max-w-md">
                        {activeTab === 'english' 
                          ? "Scan the QR code to upload and share your special moments during the ceremony." 
                          : "समारोहका सुन्दर पलहरूलाई यस QR कोड मार्फत सिधै हाम्रो लाइभ एल्बममा राख्न सक्नुहुन्छ।"}
                    </p>
                    <a 
                      href={albumLink} 
                      target="_blank" 
                      rel="noopener noreferrer" 
                      className="inline-flex items-center gap-4 bg-amber-700 text-white px-10 py-5 rounded-full text-xs font-black tracking-[0.2em] hover:bg-amber-800 shadow-xl transition-all active:scale-95"
                    >
                        {activeTab === 'english' ? "OPEN ALBUM" : "एल्बम खोल्नुहोस्"} <Share2 size={18}/>
                    </a>
                </div>
                
                <div className="relative z-10 p-6 bg-white border-4 border-amber-100 rounded-[2.5rem] shadow-2xl">
                    <img src={qrCodeUrl} alt="QR Code" className="w-48 h-48" />
                    <div className="mt-4 text-center">
                        <p className="text-stone-400 text-[9px] font-black uppercase tracking-[0.4em]">Scan to Share</p>
                    </div>
                </div>
            </div>
        </section>

        {/* Compliments Section */}
        <section className="py-40 px-6 text-center bg-white/40 backdrop-blur-sm">
          <div className="max-w-4xl mx-auto">
             <div className="inline-block border-y border-amber-200 py-20 px-6 md:px-24 relative bg-white/90 rounded-[4rem] shadow-2xl">
                <h2 className="text-3xl italic text-amber-800 mb-16 font-light">{activeTab === 'english' ? "With Best Compliments" : "दर्शनाभिलाषी"}</h2>
                
                <div className="grid md:grid-cols-2 gap-x-24 gap-y-12 text-stone-600 text-[13px] leading-loose tracking-wide">
                    <div className="space-y-4">
                        <p className="font-black text-stone-900 uppercase text-[10px] mb-6 tracking-[0.3em] border-b border-amber-100 pb-2 inline-block">Our Family</p>
                        <p>{activeTab === 'english' ? "Om Prakash Bhattarai" : "ओम प्रकाश भट्टराई"}</p>
                        <p>{activeTab === 'english' ? "Dr. Tilchandra & Dr. Sharda Bhattarai" : "डा. तिलचन्द्र र डा. शारदा भट्टराई"}</p>
                        <p>{activeTab === 'english' ? "Ganesh Dahal, Mahesh Dahal" : "गणेश दाहाल, महेश दाहाल"}</p>
                    </div>
                    <div className="space-y-4">
                        <p className="font-black text-stone-800 uppercase text-[10px] mb-6 tracking-[0.3em] border-b border-amber-100 pb-2 inline-block">Relatives</p>
                        <p>{activeTab === 'english' ? "Hem Kumari, Meena, Durga, Kavita" : "हेम कुमारी, मीना, दुर्गा, कविता"}</p>
                        <p>{activeTab === 'english' ? "Pukar Bhattarai & Family" : "पुकार भट्टराई तथा परिवार"}</p>
                    </div>
                </div>

                <div className="mt-28 pt-16 border-t border-stone-200">
                    <p className="text-amber-800 text-xs italic mb-6 uppercase tracking-[0.4em] font-bold">{t.prarthi}</p>
                    <h4 className="text-4xl md:text-6xl font-serif text-stone-900 mb-12 tracking-tight">{t.hostName}</h4>
                    
                    <div className="bg-[#FDFCF8] p-10 rounded-[2.5rem] inline-block shadow-lg border border-amber-50">
                        <p className="text-stone-400 text-[10px] uppercase tracking-[0.4em] mb-6 font-black">{t.contactLabel}</p>
                        <p className="text-stone-800 font-serif text-2xl mb-2">{t.contactName}</p>
                        <a 
                          href="tel:9851067239" 
                          className="text-amber-700 font-mono text-3xl hover:text-amber-900 transition-all flex items-center justify-center gap-3"
                        >
                            <Phone size={24} strokeWidth={2.5} /> 9851067239
                        </a>
                    </div>
                </div>
             </div>
          </div>
        </section>

        <footer className="py-20 bg-stone-900 text-white text-center text-[11px] tracking-[0.8em] uppercase font-black">
           Shakar & Jasmin • 2026
        </footer>
      </div>
    </div>
  );
};

export default App;
